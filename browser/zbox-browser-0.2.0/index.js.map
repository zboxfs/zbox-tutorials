{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/message.js","webpack:///./src/logger.js","webpack:///./src/utils.js","webpack:///./src/index.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","message","zbox","initEnv","arg","debug","type","optional","version","exists","openRepo","uri","pwd","opts","repairSuperBlock","repo","close","info","resetPassword","oldPwd","newPwd","pathExists","isFile","isDir","createFile","openFile","path","createDir","createDirAll","readDir","metadata","history","copy","from","to","removeFile","removeDir","removeDirAll","rename","file","read","readAll","readAllString","write","finish","writeOnce","seek","offset","setLen","currVersion","versionReader","TRACE","DEBUG","INFO","WARN","ERROR","OFF","base","style","lvl","error","warn","trace","loc","msg","consoleLogger","level","fmt","output","console","log","logger","[object Object]","this","cfg","isObject","__webpack_exports__","src_Zbox","ctx","resolver","worker","getParamsType","params","buffer","ArrayBuffer","undefined","byteLength","src_Base","scope","msgType","paramsType","argIsOptional","decl","find","argType","length","Promise","reject","Error","keys","some","config","transBuf","buf","str","bufView","Uint16Array","strLen","charCodeAt","str2ab","byteOffset","len","self","resolve","add","postMessage","src_Repo","super","forEach","_bindMsg","src_File","fd","src_VersionReader","vrdr","src_Resolver","map","reduce","accum","curr","event","data","err","msgTypes","result","Uint8Array","workerPath","document","currentScript","src","replace","wasmSupported","WebAssembly","instantiate","Module","of","Instance","e","Worker","indexedDB","onmessage","onerror","JSON","stringify","SeekFrom","Start","End","Current","terminate"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/*\n * Message types\n */\nconst MsgTypes = {\n  zbox: {\n    initEnv: {\n      name: 'initEnv',\n      arg: [{ debug: { type: 'boolean', optional: true } }],\n      optional: true\n    },\n    version: {\n      name: 'version',\n      arg: []\n    },\n    exists: {\n      name: 'exists',\n      arg: ['string']\n    },\n    openRepo: {\n      name: 'openRepo',\n      arg: [{\n        uri: { type: 'string' },\n        pwd: { type: 'string' },\n        opts: { type: 'object', optional: true }\n      }]\n    },\n    repairSuperBlock: {\n      name: 'repairSuperBlock',\n      arg: [{\n        uri: { type: 'string' },\n        pwd: { type: 'string' }\n      }]\n    }\n  },\n\n  repo: {\n    close: {\n      name: 'close',\n      arg: []\n    },\n    info: {\n      name: 'info',\n      arg: []\n    },\n    resetPassword: {\n      name: 'resetPassword',\n      arg: [\n        { oldPwd: { type: 'string' } },\n        { newPwd: { type: 'string' } }\n      ]\n    },\n    pathExists: {\n      name: 'pathExists',\n      arg: ['string']\n    },\n    isFile: {\n      name: 'isFile',\n      arg: ['string']\n    },\n    isDir: {\n      name: 'isDir',\n      arg: ['string']\n    },\n    createFile: {\n      name: 'createFile',\n      arg: ['string']\n    },\n    openFile: {\n      name: 'openFile',\n      arg: [\n        'string',\n        {\n          path: { type: 'boolean' },\n          opts: { type: 'object', optional: true }\n        }\n      ]\n    },\n    createDir: {\n      name: 'createDir',\n      arg: ['string']\n    },\n    createDirAll: {\n      name: 'createDirAll',\n      arg: ['string']\n    },\n    readDir: {\n      name: 'readDir',\n      arg: ['string']\n    },\n    metadata: {\n      name: 'metadata',\n      arg: ['string']\n    },\n    history: {\n      name: 'history',\n      arg: ['string']\n    },\n    copy: {\n      name: 'copy',\n      arg: [\n        { from: { type: 'string' } },\n        { to: { type: 'string' } }\n      ]\n    },\n    removeFile: {\n      name: 'removeFile',\n      arg: ['string']\n    },\n    removeDir: {\n      name: 'removeDir',\n      arg: ['string']\n    },\n    removeDirAll: {\n      name: 'removeDirAll',\n      arg: ['string']\n    },\n    rename: {\n      name: 'rename',\n      arg: [\n        { from: { type: 'string' } },\n        { to: { type: 'string' } }\n      ]\n    }\n  },\n\n  file: {\n    close: {\n      name: 'close',\n      arg: []\n    },\n    read: {\n      name: 'read',\n      arg: ['buffer']\n    },\n    readAll: {\n      name: 'readAll',\n      arg: []\n    },\n    readAllString: {\n      name: 'readAllString',\n      arg: []\n    },\n    write: {\n      name: 'write',\n      arg: ['string', 'buffer']\n    },\n    finish: {\n      name: 'finish',\n      arg: []\n    },\n    writeOnce: {\n      name: 'writeOnce',\n      arg: ['string', 'buffer']\n    },\n    seek: {\n      name: 'seek',\n      arg: [ {\n        from: { type: 'number' },\n        offset: { type: 'number' }\n      }]\n    },\n    setLen: {\n      name: 'setLen',\n      arg: ['number']\n    },\n    currVersion: {\n      name: 'currVersion',\n      arg: []\n    },\n    metadata: {\n      name: 'metadata',\n      arg: []\n    },\n    history: {\n      name: 'history',\n      arg: []\n    },\n    versionReader: {\n      name: 'versionReader',\n      arg: ['number']\n    }\n  },\n\n  versionReader: {\n    close: {\n      name: 'close',\n      arg: []\n    },\n    read: {\n      name: 'read',\n      arg: ['buffer']\n    },\n    readAll: {\n      name: 'readAll',\n      arg: []\n    },\n    readAllString: {\n      name: 'readAllString',\n      arg: []\n    },\n    seek: {\n      name: 'seek',\n      arg: [{\n        from: { type: 'number' },\n        offset: { type: 'number' }\n      }]\n    }\n  }\n};\n\nexport default MsgTypes;\n","const TRACE = 1;\nconst DEBUG = 2;\nconst INFO = 3;\nconst WARN = 4;\nconst ERROR = 5;\nconst OFF = 99;\n\n// log style definitions\nconst base = 'color: white; padding: 0 3px; width: 4em; display: inline-block; text-align: center; background: ';\nconst style = {\n  lvl: {\n    error: base + 'darkred',\n    warn: base + 'orange',\n    info: base + 'green',\n    debug: base + 'blue',\n    trace: base + 'gray'\n  },\n  loc: 'font-weight: bold; color: inherit; opacity: 0.5;',\n  msg: 'background: inherit; color: inherit'\n};\n\n// console logger\nfunction consoleLogger(level, msg, from) {\n  const loc = from || 'index.js';\n  const fmt = `[%c${level}%c ${loc}%c] ${msg}`;\n  let output;\n  switch (level) {\n    case 'trace': output = console.log; break;\n    case 'debug': output = console.debug; break;\n    case 'info': output = console.info; break;\n    case 'warn': output = console.warn; break;\n    case 'error': output = console.error; break;\n    default: output = console.log; break;\n  }\n  output(fmt, style.lvl[level], style.loc, style.msg);\n}\n\n// logger\nclass Logger {\n  constructor() {\n    this.level = WARN;\n    this.output = null;\n  }\n\n  config(opts) {\n    let cfg = opts || {};\n\n    const level = cfg.level || 'warn';\n    switch (level) {\n      case 'trace': this.level = TRACE; break;\n      case 'debug': this.level = DEBUG; break;\n      case 'info': this.level = INFO; break;\n      case 'warn': this.level = WARN; break;\n      case 'error': this.level = ERROR; break;\n      case 'off': this.level = OFF; break;\n      default: this.level = WARN; break;\n    }\n\n    this.output = cfg.logger || consoleLogger;\n  }\n\n  trace(msg, from) {\n    if (this.level <= TRACE) this.output('trace', msg, from);\n  }\n\n  debug(msg, from) {\n    if (this.level <= DEBUG) this.output('debug', msg, from);\n  }\n\n  info(msg, from) {\n    if (this.level <= INFO) this.output('info', msg, from);\n  }\n\n  warn(msg, from) {\n    if (this.level <= WARN) this.output('warn', msg, from);\n  }\n\n  error(msg, from) {\n    if (this.level <= ERROR) this.output('error', msg, from);\n  }\n}\n\nexport let logger = new Logger();\n","// check if it is object\nexport function isObject(a) {\n  return a !== null && typeof a === 'object';\n}\n\n// check if it is number\nexport function isNumber(n) {\n  return typeof n === 'number';\n}\n\n// check if it is string\nexport function isString(s) {\n  return typeof s === 'string';\n}\n\n// check if it is array buffer view\nexport function isArrayBufferView(value) {\n  return value\n    && value.buffer instanceof ArrayBuffer\n    && value.byteLength !== undefined;\n}\n\n// convert ArrayBuffer to String\nexport function ab2str(buf) {\n  return String.fromCharCode.apply(null, new Uint16Array(buf));\n}\n\n// convert String to ArrayBuffer\nexport function str2ab(str) {\n  var buf = new ArrayBuffer(str.length * 2); // 2 bytes for each char\n  var bufView = new Uint16Array(buf);\n  for (var i = 0, strLen = str.length; i < strLen; i++) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\n\n// ensure arg is string\nexport function ensureStr(s) {\n  if (typeof s !== 'string') {\n    throw 'Wrong argument, string required';\n  }\n}\n\n// ensure two args are string\nexport function ensureStr2(s, s2) {\n  if (typeof s !== 'string' || typeof s2 !== 'string') {\n    throw 'Wrong argument, string required';\n  }\n}\n\n// ensure one parameter is positive integer number\nexport function ensureInt(n) {\n  if (!Number.isInteger(n) || n < 0) {\n    throw 'Wrong argument, positive integer required';\n  }\n}\n\n// ensure one parameter is positive or negative integer number\nexport function ensureIntOrNeg(n) {\n  if (!Number.isInteger(n)) {\n    throw 'Wrong argument, integer required';\n  }\n}\n","import MsgTypes from \"./message\";\nimport { logger } from './logger';\nimport { isObject, isNumber, isString, isArrayBufferView, str2ab } from \"./utils\";\n\n// global context\nconst ctx = {\n  resolver: null,\n  worker: null\n};\n\nfunction getParamsType(params) {\n  if (isString(params)) {\n    return 'string';\n  } else if (isNumber(params)) {\n    return 'number';\n  } else if (isArrayBufferView(params)) {\n    return 'buffer';\n  } else if (params instanceof ArrayBuffer) {\n    return 'buffer';\n  } else if (isObject(params)) {\n    return 'object';\n  } else if (params === undefined) {\n    return 'undefined'\n  }\n  return 'other';\n}\n\nclass Base {\n  constructor(scope) {\n    this.scope = scope;\n  }\n\n  // bind message resolver and post message to worker\n  _bindMsg(msgType, object, params) {\n    const msg = {\n      scope: this.scope,\n      type: msgType,\n      object,\n      params\n    };\n\n    // check parameters type\n    const paramsType = getParamsType(params);\n    const arg = MsgTypes[this.scope][msgType].arg;\n    const argIsOptional = MsgTypes[this.scope][msgType].optional;\n    const decl = arg.find(arg => {\n      const argType = isObject(arg) ? 'object' : arg;\n      return paramsType === argType;\n    });\n    if (decl === undefined && arg.length > 0 && !argIsOptional) {\n      return Promise.reject(new Error('Wrong argument'));\n    }\n\n    // check required keys if params is object\n    if (paramsType === 'object' && isObject(decl)) {\n      const notMatched = Object.keys(decl).some(key => {\n        const required = !decl[key].optional;\n        return required && !params.hasOwnProperty(key);\n      });\n      if (notMatched) {\n        return Promise.reject(new Error('Wrong argument'));\n      }\n    }\n\n    // set up logger\n    if (msgType === 'initEnv') {\n      if (msg.params && msg.params.log) {\n        logger.config(msg.params.log);\n        // cannot send logger functions to worker, so delete it\n        delete msg.params.log.logger;\n      }\n    }\n\n    // deal with array buffer transfer\n    let transBuf = undefined;\n    if (msgType === 'read' || msgType === 'write' || msgType === 'writeOnce') {\n      let buf = params.buffer || params;\n\n      if (paramsType === 'string') {\n        buf = str2ab(params);\n      }\n\n      msg.params = {\n        buf,\n        offset: params.byteOffset || 0,\n        len: params.byteLength\n      };\n\n      transBuf = [buf];\n    }\n\n    const self = this;\n\n    return new Promise((resolve, reject) => {\n      ctx.resolver.add(self.scope, msgType, resolve, reject);\n      ctx.worker.postMessage(msg, transBuf);\n    });\n  }\n}\n\nclass Repo extends Base {\n  constructor() {\n    super('repo');\n\n    // add methods based on message types\n    Object.keys(MsgTypes[this.scope]).forEach(msgType => {\n      Repo.prototype[msgType] = this._bindMsg.bind(this, msgType, null);\n    });\n  }\n}\n\nclass File extends Base {\n  constructor(fd) {\n    super('file');\n    this.fd = fd;\n\n    // add methods based on message types\n    Object.keys(MsgTypes[this.scope]).forEach(msgType => {\n      File.prototype[msgType] = this._bindMsg.bind(this, msgType, this.fd);\n    });\n  }\n}\n\nclass VersionReader extends Base {\n  constructor(vrdr) {\n    super('versionReader');\n    this.vrdr = vrdr;\n\n    // add methods based on message types\n    Object.keys(MsgTypes[this.scope]).forEach(msgType => {\n      VersionReader.prototype[msgType] = this._bindMsg.bind(this, msgType, this.vrdr);\n    });\n  }\n}\n\nclass Resolver {\n  constructor() {\n    this.map = Object.keys(MsgTypes).reduce((accum, curr) => {\n      accum[curr] = Object.keys(MsgTypes[curr]).reduce((a, c) => {\n        a[c] = { resolve: null, reject: null };\n        return a;\n      }, {});\n      return accum;\n    }, {});\n  }\n\n  add(scope, msgType, resolve, reject) {\n    this.map[scope][msgType] = { resolve, reject };\n  }\n\n  resolve(event) {\n    const msg = event.data;\n    //console.log(`worker -> main: ${JSON.stringify(msg)}`);\n\n    // log out message\n    if (msg.scope === 'log') {\n      switch (msg.level) {\n        case 'error':\n          logger.error(msg.msg, msg.from);\n          break;\n\n        case 'warn':\n          logger.warn(msg.msg, msg.from);\n          break;\n\n        case 'info':\n          logger.info(msg.msg, msg.from);\n          break;\n\n        case 'debug':\n          logger.debug(msg.msg, msg.from);\n          break;\n\n        case 'trace':\n          logger.trace(msg.msg, msg.from);\n          break;\n      }\n      return;\n    }\n\n    if (msg.error) {\n      const err = new Error(msg.error);\n      this.map[msg.scope][msg.type].reject(err);\n      return;\n    }\n\n    const msgTypes = MsgTypes[msg.scope];\n    let result = msg.result;\n\n    switch (msg.scope) {\n      case 'zbox': {\n        switch (msg.type) {\n          case msgTypes.openRepo.name:\n            result = new Repo();\n            break;\n        }\n        break;\n      }\n\n      case 'repo': {\n        switch (msg.type) {\n          case msgTypes.openFile.name:\n          case msgTypes.createFile.name:\n            result = new File(result);\n            break;\n        }\n        break;\n      }\n\n      case 'file': {\n        switch (msg.type) {\n          case msgTypes.read.name:\n            result = new Uint8Array(result.buf, result.offset, result.len);\n            break;\n\n          case msgTypes.readAll.name:\n            result = new Uint8Array(result);\n            break;\n\n          case msgTypes.versionReader.name:\n            result = new VersionReader(result);\n            break;\n        }\n        break;\n      }\n\n      case 'versionReader': {\n        switch (msg.type) {\n          case msgTypes.read.name:\n            result = new Uint8Array(result.buf, result.offset, result.len);\n            break;\n\n          case msgTypes.readAll.name:\n            result = new Uint8Array(result);\n            break;\n        }\n        break;\n      }\n    }\n\n    this.map[msg.scope][msg.type].resolve(result);\n  }\n}\n\n// get worker script path\nconst workerPath = document.currentScript.src.replace(/index.js$/, 'worker.js');\n\n// detect WebAssembly support\nconst wasmSupported = (() => {\n  try {\n    if (typeof WebAssembly === \"object\"\n      && typeof WebAssembly.instantiate === \"function\")\n    {\n      const module = new WebAssembly.Module(Uint8Array.of(\n        0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00\n      ));\n      if (module instanceof WebAssembly.Module)\n        return new WebAssembly.Instance(module) instanceof WebAssembly.Instance;\n    }\n  } catch (e) {\n  }\n  return false;\n})();\n\nexport class Zbox extends Base {\n  constructor() {\n    super('zbox');\n\n    // check browser support\n    if (!wasmSupported) {\n      throw \"Your browser doesn't support WebAssembly\";\n    }\n    if (!window.Worker) {\n      throw \"Your browser doesn't support Worker\";\n    }\n    if (!window.indexedDB) {\n      throw \"Your browser doesn't support IndexedDB\";\n    }\n\n    // initialise global context objects\n    ctx.resolver = new Resolver();\n    ctx.worker = new Worker(workerPath, { name: 'ZboxWorker' });\n    ctx.worker.onmessage = ctx.resolver.resolve.bind(ctx.resolver);\n    ctx.worker.onerror = (err) => {\n      logger.error(`ZboxFS worker error: ${JSON.stringify(err)}`);\n    };\n\n    // add methods based on message types\n    Object.keys(MsgTypes[this.scope]).forEach(msgType => {\n      Zbox.prototype[msgType] = this._bindMsg.bind(this, msgType, null);\n    });\n  }\n\n  static get SeekFrom() {\n    return {\n      Start: 0,\n      End: 1,\n      Current: 2\n    };\n  }\n\n  exit() {\n    if (ctx.worker) {\n      ctx.worker.terminate();\n      ctx.worker = null;\n      logger.info('ZboxFS exited');\n    }\n    return Promise.resolve();\n  }\n}\n"],"sourceRoot":""}